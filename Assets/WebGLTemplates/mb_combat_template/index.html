<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="TemplateAsset/reset.css">
    <link rel="stylesheet" href="TemplateAsset/style.css">

    <title>MetaBaysGame</title>
  </head>
  <body>
    <div class="webgl-wrapper">
      <div class="aspect"></div>
      <div class="webgl-content">
        <div id="unityContainer">
          <canvas id="unity-canvas" style="background: {{{ BACKGROUND_FILENAME ? 'url(\'Build/' + BACKGROUND_FILENAME.replace(/'/g, '%27') + '\') center / cover' : BACKGROUND_COLOR }}}"></canvas>
        </div>
      </div>
    </div>

    <div class="footer">
      <div id="fullscreen-button"></div>
    </div>
    
    <!-- control -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      var t1_Ids = ["1","3","4","7","11","17","21","23","24","26","28","29","55","56","57","58","61","64","66","69","74","76","81","83","84","87","88","93","94","96","99","102","103","104","108","109","110","115","117","119","120","122","123","128","129","130","131","133","134","136","139","141","147","151","152","165","168","169","172","173","175","176","177","180","184","185","189","190","191","195","198","200"];
      var t2_Ids = ["0","2","5","6","8","9","10","13","20","22","25","30","31","59","60","62","65","67","68","71","72","73","75","77","80","82","85","89","90","95","101","105","107","111","116","118","121","124","125","127","132","138","142","143","145","148","149","150","153","166","167","170","171","174","181","182","183","187","188","192","193","194","196"];
      var t3_Ids = ["14","15","18","19","27","32","35","36","37","38","39","40","41","42","44","45","47","48","49","51","52","53","54","63","78","79","86","91","92","100","106","112","114","137","140","146","154","155","157","158","159","160","162","163","179","186","197","199"];
      var t4_Ids = ["12","33","34","43","46","70","97","113","126","135","144","156","178"];
      var t5_Ids = ["16","98","161","164"];

      function CallCombatStart() {
        var respond = {};
        respond.success = true;
        respond.body = {
          combat: {
            id: "21",
            combatType: "ROBBERY",
            stage: "TAVERN_01"
          },
          option: {
            bgmVolume: 0.2,
            sfxVolume: 1
          },
          teammates: [
            {
              name: "MetaBays Pirate #156",
              image: "https://metabays.sfo3.cdn.digitaloceanspaces.com/assets/pirate/tier_4/001-080-005-003-018-021-022-045-001-009-000/img1024.png",
              charType: "PIRATE",
              partsCode: "001-080-005-003-018-021-022-045-001-009-000",
              tier: "4",
              turnSpeed: 72,
              hp: 110,
              energy: 79,
              energyRecover: 8,
              normalDamage: 17,
              missChance: 22,
              criticalChance: 12,
              luck: 63,
              specials: [
                {
                  name: "JUMP_ATTACK",
                  damage: 32,
                  energy: 10
                },
                {
                  name: "GUN_ATTACK",
                  damage: 53,
                  energy: 20
                }
              ]
            },
            {
              name: "MetaBays Pirate #90",
              image: "https://metabays.sfo3.cdn.digitaloceanspaces.com/assets/pirate/tier_2/001-072-004-067-004-007-000-000-000-000-000/img1024.png",
              charType: "PIRATE",
              partsCode: "001-072-004-067-004-007-000-000-000-000-000",
              tier: "2",
              turnSpeed: 36,
              hp: 72,
              energy: 30,
              energyRecover: 7,
              normalDamage: 7,
              missChance: 23,
              criticalChance: 13,
              luck: 29,
              specials: [
                {
                  name: "JUMP_ATTACK",
                  damage: 10,
                  energy: 10
                }
              ]
            },
            {
              name: "MetaBays Pirate #101",
              image: "https://metabays.sfo3.cdn.digitaloceanspaces.com/assets/pirate/tier_2/000-025-013-020-008-007-000-000-000-000-000/img1024.png",
              charType: "PIRATE",
              partsCode: "000-025-013-020-008-007-000-000-000-000-000",
              tier: "2",
              turnSpeed: 31,
              hp: 46,
              energy: 41,
              energyRecover: 8,
              normalDamage: 8,
              missChance: 22,
              criticalChance: 12,
              luck: 21,
              specials: [
                {
                  name: "JUMP_ATTACK",
                  damage: 15,
                  energy: 10
                }
              ]
            },
            {
              name: "MetaBays Pirate #12",
              image: "https://metabays.sfo3.cdn.digitaloceanspaces.com/assets/pirate/tier_4/000-114-004-071-011-012-022-026-001-005-000/img1024.png",
              charType: "PIRATE",
              partsCode: "000-114-004-071-011-012-022-026-001-005-000",
              tier: "4",
              turnSpeed: 64,
              hp: 106,
              energy: 75,
              energyRecover: 8,
              normalDamage: 17,
              missChance: 27,
              criticalChance: 17,
              luck: 71,
              specials: [
                {
                  name: "JUMP_ATTACK",
                  damage: 33,
                  energy: 10
                },
                {
                  name: "GUN_ATTACK",
                  damage: 55,
                  energy: 20
                }
              ]
            },
            {
              name: "MetaBays Pirate #33",
              image: "https://metabays.sfo3.cdn.digitaloceanspaces.com/assets/pirate/tier_4/000-058-013-066-014-009-026-031-001-010-000/img1024.png",
              charType: "PIRATE",
              partsCode: "000-058-013-066-014-009-026-031-001-010-000",
              tier: "4",
              turnSpeed: 73,
              hp: 150,
              energy: 75,
              energyRecover: 9,
              normalDamage: 12,
              missChance: 26,
              criticalChance: 16,
              luck: 57,
              specials: [
                {
                  name: "JUMP_ATTACK",
                  damage: 23,
                  energy: 10
                },
                {
                  name: "GUN_ATTACK",
                  damage: 48,
                  energy: 20
                }
              ]
            }
          ],
          ship: {
            name: "MetaBays Ship #1",
            image: "https://metabays.sfo3.cdn.digitaloceanspaces.com/assets/pirate/tier_1/000-035-016-014-000-000-000-000-000-000-000/img350.png",
            partsCode: "001-003-004-001-000-000-000",
            tier: "2",
            cannonDamage: 40,
            cannonTurn: 4
          },
          waves: [
            {
              enemies: [
                {
                  name: "MetaBays Pirate #27",
                  image: "https://metabays.sfo3.cdn.digitaloceanspaces.com/assets/pirate/tier_3/000-093-008-062-006-003-004-044-000-000-000/img1024.png",
                  charType: "PIRATE",
                  partsCode: "000-093-008-062-006-003-004-044-000-000-000",
                  tier: "3",
                  turnSpeed: 61,
                  hp: 112,
                  energy: 61,
                  energyRecover: 7,
                  normalDamage: 8,
                  missChance: 25,
                  criticalChance: 15,
                  luck: 49,
                  specials: [
                    {
                      name: "JUMP_ATTACK",
                      damage: 15,
                      energy: 10
                    }
                  ]
                },
                {
                  name: "MetaBays Pirate #80",
                  image: "https://metabays.sfo3.cdn.digitaloceanspaces.com/assets/pirate/tier_2/001-078-000-008-011-005-000-000-000-000-000/img1024.png",
                  charType: "PIRATE",
                  partsCode: "001-078-000-008-011-005-000-000-000-000-000",
                  tier: "2",
                  turnSpeed: 31,
                  hp: 88,
                  energy: 45,
                  energyRecover: 5,
                  normalDamage: 9,
                  missChance: 22,
                  criticalChance: 12,
                  luck: 19,
                  specials: [
                    {
                      name: "JUMP_ATTACK",
                      damage: 18,
                      energy: 10
                    }
                  ]
                },
                {
                  name: "MetaBays Pirate #133",
                  image: "https://metabays.sfo3.cdn.digitaloceanspaces.com/assets/pirate/tier_1/000-038-013-041-000-000-000-000-000-000-000/img1024.png",
                  charType: "PIRATE",
                  partsCode: "000-038-013-041-000-000-000-000-000-000-000",
                  tier: "1",
                  turnSpeed: 26,
                  hp: 10,
                  energy: 12,
                  energyRecover: 5,
                  normalDamage: 3,
                  missChance: 23,
                  criticalChance: 13,
                  luck: 27,
                  specials: [
                    {
                      name: "JUMP_ATTACK",
                      damage: 4,
                      energy: 10
                    }
                  ]
                },
                {
                  name: "MetaBays Pirate #7",
                  image: "https://metabays.sfo3.cdn.digitaloceanspaces.com/assets/pirate/tier_1/000-023-012-017-000-000-000-000-000-000-000/img1024.png",
                  charType: "PIRATE",
                  partsCode: "000-023-012-017-000-000-000-000-000-000-000",
                  tier: "1",
                  turnSpeed: 20,
                  hp: 36,
                  energy: 8,
                  energyRecover: 4,
                  normalDamage: 3,
                  missChance: 23,
                  criticalChance: 13,
                  luck: 32,
                  specials: [
                    {
                      name: "JUMP_ATTACK",
                      damage: 5,
                      energy: 10
                    }
                  ]
                },
                {
                  name: "MetaBays Pirate #200",
                  image: "https://metabays.sfo3.cdn.digitaloceanspaces.com/assets/pirate/tier_1/000-011-006-097-000-000-000-000-000-000-000/img1024.png",
                  charType: "PIRATE",
                  partsCode: "000-011-006-097-000-000-000-000-000-000-000",
                  tier: "1",
                  turnSpeed: 16,
                  hp: 64,
                  energy: 4,
                  energyRecover: 5,
                  normalDamage: 2,
                  missChance: 22,
                  criticalChance: 12,
                  luck: 23,
                  specials: [
                    {
                      name: "JUMP_ATTACK",
                      damage: 4,
                      energy: 10
                    }
                  ]
                }
              ]
            },
            {
              enemies: [
                {
                  name: "MetaBays Pirate #142",
                  image: "https://metabays.sfo3.cdn.digitaloceanspaces.com/assets/pirate/tier_2/001-047-007-079-002-012-000-000-000-000-000/img1024.png",
                  charType: "PIRATE",
                  partsCode: "001-047-007-079-002-012-000-000-000-000-000",
                  tier: "2",
                  turnSpeed: 45,
                  hp: 58,
                  energy: 33,
                  energyRecover: 5,
                  normalDamage: 9,
                  missChance: 23,
                  criticalChance: 13,
                  luck: 25,
                  specials: [
                    {
                      name: "JUMP_ATTACK",
                      damage: 17,
                      energy: 10
                    }
                  ]
                },
                {
                  name: "MetaBays Pirate #16",
                  image: "https://metabays.sfo3.cdn.digitaloceanspaces.com/assets/pirate/tier_5/001-062-008-044-017-004-007-040-002-010-003/img1024.png",
                  charType: "PIRATE",
                  partsCode: "001-062-008-044-017-004-007-040-002-010-003",
                  tier: "5",
                  turnSpeed: 88,
                  hp: 188,
                  energy: 86,
                  energyRecover: 11,
                  normalDamage: 18,
                  missChance: 27,
                  criticalChance: 17,
                  luck: 68,
                  specials: [
                    {
                      name: "JUMP_ATTACK",
                      damage: 36,
                      energy: 10
                    },
                    {
                      name: "GUN_ATTACK",
                      damage: 66,
                      energy: 20
                    }
                  ]
                },
                {
                  name: "MetaBays Pirate #85",
                  image: "https://metabays.sfo3.cdn.digitaloceanspaces.com/assets/pirate/tier_2/000-046-011-063-017-006-000-000-000-000-000/img1024.png",
                  charType: "PIRATE",
                  partsCode: "000-046-011-063-017-006-000-000-000-000-000",
                  tier: "2",
                  turnSpeed: 27,
                  hp: 76,
                  energy: 30,
                  energyRecover: 7,
                  normalDamage: 8,
                  missChance: 23,
                  criticalChance: 13,
                  luck: 32,
                  specials: [
                    {
                      name: "JUMP_ATTACK",
                      damage: 15,
                      energy: 10
                    }
                  ]
                },
                {
                  name: "MetaBays Pirate #113",
                  image: "https://metabays.sfo3.cdn.digitaloceanspaces.com/assets/pirate/tier_4/000-057-009-003-008-015-016-057-001-005-000/img1024.png",
                  charType: "PIRATE",
                  partsCode: "000-057-009-003-008-015-016-057-001-005-000",
                  tier: "4",
                  turnSpeed: 75,
                  hp: 128,
                  energy: 53,
                  energyRecover: 15,
                  normalDamage: 15,
                  missChance: 26,
                  criticalChance: 16,
                  luck: 58,
                  specials: [
                    {
                      name: "JUMP_ATTACK",
                      damage: 28,
                      energy: 10
                    },
                    {
                      name: "GUN_ATTACK",
                      damage: 60,
                      energy: 20
                    }
                  ]
                },
                {
                  name: "MetaBays Pirate #119",
                  image: "https://metabays.sfo3.cdn.digitaloceanspaces.com/assets/pirate/tier_1/000-101-002-092-000-000-000-000-000-000-000/img1024.png",
                  charType: "PIRATE",
                  partsCode: "000-101-002-092-000-000-000-000-000-000-000",
                  tier: "1",
                  turnSpeed: 4,
                  hp: 32,
                  energy: 6,
                  energyRecover: 6,
                  normalDamage: 7,
                  missChance: 22,
                  criticalChance: 12,
                  luck: 18,
                  specials: [
                    {
                      name: "JUMP_ATTACK",
                      damage: 12,
                      energy: 10
                    }
                  ]
                }
              ]
            }
          ]
        };
        myGameInstance.SendMessage ("WebBridge", "RespondCombatStart", JSON.stringify(respond));
      }
      
      function CallCombatClose(message) {
        
      }
    </script>

    <!-- load unity -->
    <script src="loader.js"></script>
    <script>
      createUnityInstance(document.querySelector("#unity-canvas"), {
        dataUrl: "Build/{{{ DATA_FILENAME }}}",
        frameworkUrl: "Build/{{{ FRAMEWORK_FILENAME }}}",
        codeUrl: "Build/{{{ CODE_FILENAME }}}",
#if MEMORY_FILENAME
        memoryUrl: "Build/{{{ MEMORY_FILENAME }}}",
#endif
#if SYMBOLS_FILENAME
        symbolsUrl: "Build/{{{ SYMBOLS_FILENAME }}}",
#endif
        streamingAssetsUrl: "StreamingAssets",
        companyName: "{{{ COMPANY_NAME }}}",
        productName: "{{{ PRODUCT_NAME }}}",
        productVersion: "{{{ PRODUCT_VERSION }}}",
      }).then((unityInstance) => {
        myGameInstance = unityInstance;
      });
    </script>

    <!-- fullscreen -->
    <script>
      var fullscreenBtn = document.querySelector("#fullscreen-button");
      fullscreenBtn.onclick = () => {
        myGameInstance.SetFullscreen(1);
      };
    </script>
  </body>
</html>
